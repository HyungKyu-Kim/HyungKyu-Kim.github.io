<!DOCTYPE html>
<html lang='en'>
  <head>
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Lung Cancer Diagnosis Clinical Decision Support System | Your awesome title</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Lung Cancer Diagnosis Clinical Decision Support System" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The purpose of this system is to help doctors diagnose of lung cancer. It supports diagnosis by deep learning based on detection and classification nodules." />
<meta property="og:description" content="The purpose of this system is to help doctors diagnose of lung cancer. It supports diagnosis by deep learning based on detection and classification nodules." />
<link rel="canonical" href="http://localhost:4000/portfolio/medipixel/lung_cancer_diagnosis_clinical_decision_support_system" />
<meta property="og:url" content="http://localhost:4000/portfolio/medipixel/lung_cancer_diagnosis_clinical_decision_support_system" />
<meta property="og:site_name" content="Your awesome title" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-04-13T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Lung Cancer Diagnosis Clinical Decision Support System" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2019-04-13T00:00:00+09:00","datePublished":"2019-04-13T00:00:00+09:00","description":"The purpose of this system is to help doctors diagnose of lung cancer. It supports diagnosis by deep learning based on detection and classification nodules.","headline":"Lung Cancer Diagnosis Clinical Decision Support System","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/portfolio/medipixel/lung_cancer_diagnosis_clinical_decision_support_system"},"url":"http://localhost:4000/portfolio/medipixel/lung_cancer_diagnosis_clinical_decision_support_system"}</script>
<!-- End Jekyll SEO tag -->

  <link rel='stylesheet' href='/assets/main.css'>
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Your awesome title" />
  

</head>

  <body>
    <div class='layout'>
      <header class='header'>
  <nav class='header__nav'>
    
      
        <a class='header__nav__item' href='/'>Hyungkyu Kim</a>
      
    
      
        <a class='header__nav__item--selected' href='/portfolio'>Portfolio</a>
      
    
  </nav>
  <hr width=100% border-color=#EBEBEB size=1>
</header>
      <main class='main'>
        <article class='post'>
  <div class="posts__navigation">
    <a href="/portfolio"> Portfolio </a> &nbsp; > &nbsp; <a href="/portfolio#Medipixel"> Medipixel </a> &nbsp; > &nbsp; Lung Cancer Diagnosis Clinical Decision Support System
  </div>
  <br/>
  <div>
  
    
  
    
      <img src="/images/medipixel/logo_medipixel.png" width="100px" style="margin-bottom:35px">
      
  </div>
  <h1>Lung Cancer Diagnosis Clinical Decision Support System</h1>
  <p>The purpose of this system is to help doctors diagnose of lung cancer. It supports diagnosis by deep learning based on detection and classification nodules.</p>

<!--break-->

<h4 id="my-role">My Role</h4>
<p>Project Leader</p>
<ul>
  <li>Design a whole data pipeline</li>
  <li>Implement <a href="https://en.wikipedia.org/wiki/DICOM">DICOM</a>-based data preprocessing module</li>
  <li>Design and implement 3D U-net based detection neural network</li>
  <li>Design and implement 3D Resnet based classification neural network</li>
</ul>

<hr />
<h4 id="project-detail">Project Detail</h4>

<!-- Feel free to change the width and height to your desired video size. -->

<div class="embed-container">
  <iframe src="https://www.youtube.com/embed/MP9-zlR1cYc" width="700" height="480" frameborder="0" allowfullscreen="">
  </iframe>
</div>

<p><br /></p>

<p>Lung cancer is ranks highly among all causes in death rate. 
In 2015, 17,399 people were killed by lung cancer in Korea, making up 27.9% of all cancer related deaths.
The reason for its high death rate is the lack of an efficient inspection process.</p>

<p>In many cases, a biopsy is taken to confirm whether a patient has lung cancer or not.
It, however, should be avoided as much as possible since it is an invasive inspection. 
Typically a chest computed tomography (CT) is used for biopsy screening, so a radiologist’s ability to read the CT correctly is very important.</p>

<p>To better share experience accumulated over time, decision support system based on AI have been widely adopted in various industrial fields. 
In the medical domain, the need for a quick and precise diagnosis decision is intensifying. 
Hence, this kind of system has been researched by many scientists and Medipixel’s lung cancer project is designed to fulfill those needs. 
We worked jointly with <a href="http://eng.amc.seoul.kr/gb/lang/main.do">Asan Medical Center</a> and ended up developing the Lung Cancer Diagnosis Clinical Decision Support System.</p>

<p>It has the following advantages</p>
<ul>
  <li>Detects nodules that can be missed → increased diagnosis accuracy</li>
  <li>Assists doctors to read chest CT scan with ease → increased diagnosis productivity</li>
</ul>

<p><img src="/images/medipixel/mp_chest_system.png" alt="Alt text" /></p>

<h5 id="system-features">System Features</h5>
<p>The system features are below</p>
<ul>
  <li>Supports diagnosis process of whether nodule is malignant or benign</li>
  <li>Handles non-small cell lung cancer nodule in the 10mm~30mm range</li>
  <li>Shows the number of nodules and nodule region of interests</li>
  <li>Indicates estimated lung cancer risk percentage</li>
</ul>

<p><img src="/images/medipixel/mp_screen_shot.png" alt="Alt text" /></p>

<h5 id="tasks">Tasks</h5>
<p>I was involved as a project leader who was in charge of designing the overall process and data flow.</p>

<p>I decided to approach this project with a practical view. 
Since most processes in deep learning system are formulaic, I did not focus on designing a system structure. 
Making a completely new model was not a focus either. 
Instead, we put more time into finding a high performance model adopted in the medical domain and improving upon it.</p>

<h5 id="dataset">Dataset</h5>
<p>One of the most important issues in a deep learning system is how to gather and handle a proper dataset.
We utilized several dataset, of hospitals involved with <a href="http://eng.amc.seoul.kr/gb/lang/main.do">Asan Medical Center</a> and an open dataset like <a href="https://biometry.nci.nih.gov/cdas/nlst/">NLST</a> to improve performance of the system. 
There were some issues with these datasets as follows</p>
<ul>
  <li>Different data format (especially open data-set)</li>
  <li>Different data modality such as resolution of CT</li>
  <li>Overwhelmingly numerous malignant nodules (more than benign nodules)</li>
  <li>Difficulty with finding completely negative data which did not have any nodule</li>
</ul>

<h6 id="preprocess">Preprocess</h6>
<p>We had to preprocess a heterogeneous dataset through one pipeline.
Basically, it was necessary to reconstruct and normalize from 2d DICOM slices to 3d voxel data. 
Since this task was expected to take a long time, it had to be done in advance, and the results saved to a hard disk before we could with the proceed regular training process.
Main process was as follows.</p>
<ul>
  <li>Perform 3D reconstruction with a thickness of 1mm</li>
  <li>Set Hounsfield Unit between -1200 and 600</li>
  <li>Normalize each pixel value between 0 and 255</li>
</ul>

<figure>
  <img src="/images/medipixel/mp_net_preprocess0.png" width="80%" />
  <figcaption></figcaption>
</figure>

<p>Rather than using the whole voxel data, it was divided into smaller chunks due to GPU memory limitation. 
This process occurred in the training and inference routines.</p>

<figure>
  <img src="/images/medipixel/mp_net_preprocess1.png" width="68%" />
  <figcaption></figcaption>
</figure>

<h6 id="gathering-dataset">Gathering Dataset</h6>
<p>To improve performance, we needed to obtain more datasets from various sources.
The process of collecting proper data for modeling requires a significant time cost for doctors. 
Data labeling, especially, requires significant time because it is an arduous task to segment the region of nodule pixel by pixel.</p>

<p>We exerted much effort to help them.
To improve efficiency and decrease the time required, we had several meetings with doctors and proposed useful methods such as a nodule segmentation support application and semi-auto segmentation for nodule data.</p>
<figure>
  <img src="/images/medipixel/mp_chest_data0.jpg" />
  <figcaption></figcaption>
</figure>

<h5 id="deep-learning-networks">Deep Learning Networks</h5>
<p>During the research period, I realized that an ensemble strategy was efficient to improve whole system accuracy. 
After many experiments using various models, I tried to find the optimal combination. 
As a result we decided to use three Deep Neural Network(DNN) networks in the system.</p>

<h6 id="detection-network">Detection Network</h6>
<p>This network detects nodules. 
It is built based on 3d U-net. 
Detection network consists of an encoding and decoding network. 
The nodule’s features are extracted in the encoding network through 3D residual blocks.</p>

<figure>
  <img src="/images/medipixel/mp_net_detection-net.png" width="70%" />
  <figcaption></figcaption>
</figure>

<h6 id="segmentation-network">Segmentation Network</h6>
<p>This network performs segmentation of nodules in each slide based on the results from the detection network. 
Its second role is to act as a filter for false-positive regions.
Our segmentation network takes advantage of the <a href="https://arxiv.org/abs/1802.02611">Deeplab-v3+</a> network whose network structure is shown in figure below</p>
<figure>
  <img src="/images/medipixel/mp_net_segmentation-net.png" width="70%" />
  <figcaption></figcaption>
</figure>

<h6 id="classification-network">Classification Network</h6>
<p>The classification network is responsible for determining the degree of malignancy of candidate nodules. 
Features of nodules are extracted through the 3D residual network layer, and we made final result from the extracted features.</p>
<figure>
  <img src="/images/medipixel/mp_net_classification-net.png" width="70%" />
  <figcaption></figcaption>
</figure>

<h5 id="practical-technique">Practical Technique</h5>
<p>I also added a simple preprocess stage before the segmentation network to get rid of nodules in the outer body.
This stage was composed of a simple method that checks the largest contour and erodes it.
It mapped a candidate nodule region onto 2D slide and examined whether it belongs to the inside of the body.
Then any regions outside of the body were removed as false-positives.
This method has some advantages over other methods that perform complicated lung-segmentation as follows</p>
<ul>
  <li>It is much faster than a conventional segmentation method via complex algorithm</li>
  <li>It removes an ordinary lung-segmentation algorithm problem that recognizes a nodule on the wall as outside the lung</li>
  <li>It solves a region segmentation error resulting from different modality such as different CT slide scanner</li>
</ul>

<figure>
  <img src="/images/medipixel/mp_net_trick.png" width="70%" />
  <figcaption></figcaption>
</figure>

<h5 id="strengths-of-the-structure">Strengths of the Structure</h5>
<p>Generally, most cancer diagnosis systems have a similar structure. 
Among these systems, combinations with U-net based detector and classifier are popular. 
<strong>I embedded simple preprocess stage and segmentation network</strong> in center of this combination. 
The network mapped 3d suspicious chunks to 2d CT slice, and, at the same time, performed to segment area in suspicious chunks.
In this context, segmentation means scrutinizing and filtering nodules. 
So, I was able to <strong>remove many false positive nodules</strong> from the results in the first stage. 
From those features, the system gained a simple but powerful improvement.</p>

<p><img src="/images/medipixel/mp_chest_models.png" alt="Alt text" /></p>

<h5 id="conclusion">Conclusion</h5>
<p>Through interviews, we found that time spent on reading chest CT generally takes about from five to twenty minutes.
Our system achieved satisfying results that reduce time to under one minute while maintaining over 90% accuracy.</p>

<figure>
  <img src="/images/medipixel/mp_chest_auc.png" width="60%" />
  <figcaption></figcaption>
</figure>

<p>TSNE result was like below
<img src="/images/medipixel/mp_chest_tsne.png" alt="Alt text" /></p>

<hr />

<h5 id="patent">Patent</h5>
<p>[1] Pathological diagnosis method and apparatus based on machine learning 10-2020-0082660</p>

</article>

      </main>
      <footer class='footer'>
  <ul class='footer__list'>
    

    
      <li class='footer__item'>
        <a href='https://github.com/jekyll' title='github'>
          <svg class='icon'><use href='/assets/icons/github.svg#github' xlink:href='/assets/icons/github.svg#github'></use>
</svg>

        </a>
      </li>
    

    

    
      <li class='footer__item'>
        <a href='https://twitter.com/jekyllrb' title='twitter'>
          <svg class='icon'><use href='/assets/icons/twitter.svg#twitter' xlink:href='/assets/icons/twitter.svg#twitter'></use>
</svg>

        </a>
      </li>
    

    

    
  </ul>
</footer>

    </div>
  </body>
</html>
